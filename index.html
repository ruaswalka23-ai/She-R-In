<script>
  // تبويبات
  (function initTabs(){
    const headerBtns = document.querySelectorAll('#order-tabs .tab-btn');
    const panes = document.querySelectorAll('#order-tabs .tab-content');

    function activate(name){
      headerBtns.forEach(b=>b.classList.toggle('is-active', b.dataset.tab===name));
      panes.forEach(p=>p.classList.toggle('is-active', p.id === 'tab-'+name));
      history.replaceState(null, '', '#tab='+name);
    }
    headerBtns.forEach(btn=> btn.addEventListener('click', ()=> activate(btn.dataset.tab)));

    const fromHash = (location.hash || '').replace('#tab=','');
    if(fromHash && document.querySelector(`#order-tabs .tab-btn[data-tab="${fromHash}"]`)){
      activate(fromHash);
    }
  })();

  // فتح محتوى التبويب في نافذة جديدة (ينسخ نص .lang-block الحالية)
  function openGuide(type){
    const currentLang = (window.state && state.lang) || document.documentElement.lang || 'ar';
    const sel = type==='alibaba'
      ? '#tab-alibaba .lang-block[data-lang="'+currentLang+'"]'
      : '#tab-aliexpress .lang-block[data-lang="'+currentLang+'"]';
    const src = document.querySelector(sel);
    const title = type==='alibaba'
      ? (currentLang==='ar'?'تعليمات الطلب — Alibaba / Made in China': currentLang==='en'?'Order Instructions — Alibaba / Made in China':'下单说明 — 阿里巴巴 / MIC')
      : (currentLang==='ar'?'تعليمات الطلب — AliExpress': currentLang==='en'?'Order Instructions — AliExpress':'下单说明 — 速卖通');

    const w = window.open('', '_blank');
    w.document.write(`<!doctype html><html lang="${currentLang}"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>${title}</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  body{font-family:'Cairo',system-ui,Arial,sans-serif;background:#fff;color:#0f172a;margin:0}
  .wrap{max-width:900px;margin:auto;padding:24px}
  h1{font-size:22px;margin:0 0 12px}
  ol{line-height:1.8}
  .note{color:#475569}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:#f97316;color:#04130a;font-weight:700;text-decoration:none}
</style>
</head><body>
  <div class="wrap">
    <h1>${title}</h1>
    ${src ? src.innerHTML : '<p class="note">(لا يوجد محتوى)</p>'}
    <p style="margin-top:16px"><a class="btn" href="/">العودة للصفحة الرئيسية</a></p>
  </div>
</body></html>`);
    w.document.close();
  }
</script>
